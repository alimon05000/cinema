<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FC25 Турниры - Главная</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Open+Sans&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Базовые сбросы */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Montserrat', sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #1a2a6c, #b21f1f, #fdbb2d);
            color: white;
            min-height: 100vh;
        }
        
        /* Основная структура */
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 5%;
            background-color: rgba(0, 0, 0, 0.7);
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .logo-container {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .logo {
            height: 50px;
        }
        
        nav ul {
            display: flex;
            list-style: none;
            gap: 20px;
        }
        
        nav a {
            color: white;
            text-decoration: none;
            font-weight: bold;
            padding: 8px 12px;
            border-radius: 4px;
            transition: all 0.3s;
        }
        
        nav a:hover {
            background-color: rgba(255, 255, 255, 0.2);
        }
        
        nav a.active {
            background-color: rgba(255, 255, 255, 0.1);
        }
        
        .login-btn {
            background-color: #ff6b00;
        }
        
        .login-btn:hover {
            background-color: #e05e00;
        }
        
        main {
            padding: 2rem 5%;
        }
        
        section {
            margin-bottom: 3rem;
        }
        
        /* Герой секция */
        .hero {
            display: flex;
            align-items: center;
            gap: 50px;
            margin: 3rem 0;
        }
        
        .hero-content {
            flex: 1;
        }
        
        .hero-content h2 {
            font-size: 2.5rem;
            margin-bottom: 1rem;
        }
        
        .hero-content p {
            font-size: 1.2rem;
            margin-bottom: 2rem;
            opacity: 0.9;
        }
        
        .hero-image {
            flex: 1;
            text-align: center;
        }
        
        .hero-image img {
            max-width: 100%;
            height: auto;
            border-radius: 10px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.3);
        }
        
        /* Кнопки */
        .btn {
            display: inline-block;
            padding: 12px 24px;
            border-radius: 50px;
            font-weight: bold;
            text-decoration: none;
            transition: all 0.3s ease;
            margin-right: 10px;
            cursor: pointer;
            border: none;
        }
        
        .btn-primary {
            background-color: #ff6b00;
            color: white;
            border: 2px solid #ff8c00;
        }
        
        .btn-primary:hover {
            background-color: #e05e00;
            transform: translateY(-2px);
        }
        
        .btn-secondary {
            background-color: transparent;
            border: 2px solid white;
            color: white;
        }
        
        .btn-secondary:hover {
            background-color: rgba(255,255,255,0.1);
            transform: translateY(-2px);
        }
        
        .btn-danger {
            background-color: #dc3545;
            color: white;
            border: 2px solid #dc3545;
        }
        
        .btn-danger:hover {
            background-color: #c82333;
        }
        
        .btn-success {
            background-color: #28a745;
            color: white;
            border: 2px solid #28a745;
        }
        
        .btn-success:hover {
            background-color: #218838;
        }
        
        /* Особенности */
        .features {
            margin: 5rem 0;
        }
        
        .section-title {
            text-align: center;
            margin-bottom: 2rem;
            font-size: 2rem;
        }
        
        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
        }
        
        .feature-card {
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            padding: 2rem;
            border-radius: 10px;
            text-align: center;
            transition: transform 0.3s;
            cursor: pointer;
        }
        
        .feature-card:hover {
            transform: translateY(-10px);
            background: rgba(255,255,255,0.15);
        }
        
        .feature-icon {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            color: #ff6b00;
        }
        
        /* Турниры */
        .upcoming-tournaments {
            margin: 5rem 0;
        }
        
        .tournaments-carousel {
            display: flex;
            gap: 20px;
            overflow-x: auto;
            padding: 20px 0;
            scrollbar-width: thin;
            scrollbar-color: #ff6b00 rgba(255,255,255,0.1);
        }
        
        .tournaments-carousel::-webkit-scrollbar {
            height: 8px;
        }
        
        .tournaments-carousel::-webkit-scrollbar-track {
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
        }
        
        .tournaments-carousel::-webkit-scrollbar-thumb {
            background-color: #ff6b00;
            border-radius: 10px;
        }
        
        .tournament-card {
            min-width: 300px;
            background: rgba(0,0,0,0.5);
            border-radius: 10px;
            overflow: hidden;
            transition: transform 0.3s;
        }
        
        .tournament-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
        
        .tournament-image {
            width: 100%;
            height: 150px;
            object-fit: cover;
        }
        
        .tournament-info {
            padding: 15px;
        }
        
        .tournament-meta {
            margin: 10px 0;
        }
        
        .tournament-meta p {
            margin: 5px 0;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        /* Отзывы */
        .testimonials {
            margin: 5rem 0;
        }
        
        .testimonials-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
        }
        
        .testimonial-card {
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            padding: 2rem;
            border-radius: 10px;
            transition: transform 0.3s;
        }
        
        .testimonial-card:hover {
            transform: translateY(-5px);
        }
        
        .user-info {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 1rem;
        }
        
        .user-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            object-fit: cover;
            margin-bottom: 10px;
            border: 3px solid #ff6b00;
        }
        
        .user-name {
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .user-rating {
            color: #ffd700;
            margin-bottom: 10px;
        }
        
        .testimonial-text {
            font-style: italic;
            text-align: center;
        }
        
        /* Таблицы */
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
            background: rgba(0,0,0,0.5);
        }
        
        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        
        th {
            background-color: rgba(255,107,0,0.2);
        }
        
        tr:hover {
            background-color: rgba(255,255,255,0.05);
        }
        
        /* Формы */
        .form-container {
            max-width: 600px;
            margin: 0 auto;
            background: rgba(0,0,0,0.5);
            padding: 2rem;
            border-radius: 10px;
        }
        
        .form-group {
            margin-bottom: 1.5rem;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: bold;
        }
        
        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 10px;
            border-radius: 5px;
            border: none;
            background-color: rgba(255,255,255,0.9);
        }
        
        .form-group textarea {
            min-height: 100px;
            resize: vertical;
        }
        
        .form-actions {
            margin-top: 2rem;
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }
        
        /* Подвал */
        footer {
            background-color: rgba(0,0,0,0.8);
            padding: 3rem 5%;
            margin-top: 3rem;
        }
        
        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 2rem;
        }
        
        .footer-section h4 {
            margin-bottom: 1rem;
            font-size: 1.2rem;
        }
        
        .footer-section ul {
            list-style: none;
        }
        
        .footer-section ul li {
            margin-bottom: 8px;
        }
        
        .footer-section ul li a {
            color: white;
            text-decoration: none;
            transition: color 0.3s;
        }
        
        .footer-section ul li a:hover {
            color: #ff6b00;
        }
        
        .footer-section p {
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .social-links {
            display: flex;
            gap: 15px;
            margin-top: 15px;
        }
        
        .social-links a {
            color: white;
            font-size: 1.5rem;
            transition: color 0.3s;
        }
        
        .social-links a:hover {
            color: #ff6b00;
        }
        
        .copyright {
            text-align: center;
            margin-top: 2rem;
            padding-top: 2rem;
            border-top: 1px solid rgba(255,255,255,0.1);
        }
        
        /* Модальное окно */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.7);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        
        .modal-content {
            background: linear-gradient(135deg, #1a2a6c, #b21f1f);
            padding: 2rem;
            border-radius: 10px;
            max-width: 600px;
            width: 90%;
            position: relative;
            max-height: 90vh;
            overflow-y: auto;
        }
        
        .close-modal {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 1.5rem;
            cursor: pointer;
            color: white;
        }
        
        /* Команды */
        .teams-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }
        
        .team-card {
            background: rgba(255,255,255,0.1);
            padding: 1rem;
            border-radius: 5px;
            text-align: center;
            transition: all 0.3s;
            cursor: pointer;
        }
        
        .team-card:hover {
            background: rgba(255,255,255,0.2);
        }
        
        .team-card.selected {
            background: rgba(255,107,0,0.5);
            border: 2px solid #ff6b00;
        }
        
        .team-card.taken {
            background: rgba(220,53,69,0.3);
            cursor: not-allowed;
            opacity: 0.7;
        }
        
        .team-logo {
            width: 50px;
            height: 50px;
            object-fit: contain;
            margin: 0 auto 10px;
        }
        
        /* Админ панель */
        .admin-actions {
            display: flex;
            gap: 10px;
            margin: 1rem 0;
        }
        
        /* Матчи */
        .match-card {
            background: rgba(0,0,0,0.5);
            padding: 1rem;
            border-radius: 5px;
            margin-bottom: 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .match-teams {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .match-team {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .match-team-logo {
            width: 40px;
            height: 40px;
        }
        
        .match-score {
            display: flex;
            gap: 5px;
        }
        
        .match-score input {
            width: 40px;
            text-align: center;
        }
        
        .match-status {
            padding: 5px 10px;
            border-radius: 3px;
            font-size: 0.8rem;
            font-weight: bold;
        }
        
        .status-pending {
            background-color: #ffc107;
            color: black;
        }
        
        .status-confirmed {
            background-color: #28a745;
            color: white;
        }
        
        /* Турнирная таблица */
        .standings {
            margin: 2rem 0;
            background: rgba(0,0,0,0.5);
            padding: 1rem;
            border-radius: 8px;
        }
        
        .standings h3 {
            margin-bottom: 1rem;
            text-align: center;
        }
        
        /* Группировка команд по лигам */
        .league-group {
            margin-bottom: 2rem;
        }
        
        .league-title {
            background: rgba(255,107,0,0.3);
            padding: 0.5rem 1rem;
            border-radius: 5px;
            margin-bottom: 1rem;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .league-title i {
            transition: transform 0.3s;
        }
        
        .league-title.collapsed i {
            transform: rotate(-90deg);
        }
        
        .league-teams {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 1rem;
        }
        
        .league-teams.collapsed {
            display: none;
        }
        
        /* Инструкция для iOS */
        .ios-instruction {
            background: rgba(255,255,255,0.1);
            padding: 1.5rem;
            border-radius: 8px;
            margin: 2rem 0;
        }
        
        .ios-instruction h3 {
            margin-bottom: 1rem;
            color: #ff6b00;
        }
        
        .ios-instruction ol {
            padding-left: 1.5rem;
        }
        
        .ios-instruction li {
            margin-bottom: 0.5rem;
        }
        
        /* Адаптивность */
        @media (max-width: 768px) {
            header {
                flex-direction: column;
                gap: 20px;
            }
            
            nav ul {
                flex-wrap: wrap;
                justify-content: center;
            }
            
            .hero {
                flex-direction: column;
            }
            
            .hero-content {
                text-align: center;
                margin-bottom: 2rem;
            }
            
            .cta-buttons {
                display: flex;
                flex-direction: column;
                gap: 10px;
            }
            
            .btn {
                display: block;
                margin-right: 0;
                margin-bottom: 10px;
                text-align: center;
            }
            
            .tournament-card {
                min-width: 250px;
            }
            
            .form-actions {
                flex-direction: column;
            }
            
            .form-actions .btn {
                width: 100%;
            }
            
            .match-card {
                flex-direction: column;
                gap: 10px;
            }
        }
    </style>
</head>
<body>
    <!-- Шапка сайта -->
    <header>
        <div class="logo-container">
            <img src="https://www.fifplay.com/img/public/fc-25-logo.png" alt="FC25 Турниры" class="logo">
            <h1>FC25 Турниры</h1>
        </div>
        <nav>
            <ul>
                <li><a href="#" class="login-btn" data-page="login"><i class="fas fa-sign-in-alt"></i> <span id="auth-text">Вход</span></a></li>
            </ul>
        </nav>
    </header>

    <!-- Основное содержимое -->
    <main id="main-content">
        <!-- Главная страница -->
        <div id="home-page" class="page active">
            <!-- Герой-секция -->
            <section class="hero">
                <div class="hero-content">
                    <h2>Онлайн турниры по FIFA FC25</h2>
                    <p>Присоединяйся к соревнованиям, выбирай свою команду и докажи, что ты лучший!</p>
                    <div class="cta-buttons">
                        <a href="#" class="btn btn-primary" id="register-btn"><i class="fas fa-user-plus"></i> Регистрация</a>
                        <a href="#" class="btn btn-secondary" data-page="tournaments"><i class="fas fa-trophy"></i> Текущие турниры</a>
                    </div>
                </div>
                <div class="hero-image">
                    <img src="https://media.contentapi.ea.com/content/dam/ea/fifa/fifa-23/images/2022/09/f23-gameplay-feature-img-16x9.jpg.adapt.crop16x9.1023w.jpg" alt="FIFA FC25 Турниры">
                </div>
            </section>

            <!-- Особенности платформы -->
            <section class="features">
                <h2 class="section-title">Почему выбирают нас</h2>
                <div class="features-grid">
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-trophy"></i>
                        </div>
                        <h3>Профессиональные турниры</h3>
                        <p>Честные соревнования с продуманной системой рейтингов</p>
                    </div>
                    
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-chart-line"></i>
                        </div>
                        <h3>Подробная статистика</h3>
                        <p>Анализируй свои матчи и улучшай показатели</p>
                    </div>
                    
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-money-bill-wave"></i>
                        </div>
                        <h3>Призовые фонды</h3>
                        <p>Реальные денежные призы для лучших игроков</p>
                    </div>
                    
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-users"></i>
                        </div>
                        <h3>Сообщество</h3>
                        <p>Общайся с другими игроками и находи соперников</p>
                    </div>
                </div>
            </section>

            <!-- Ближайшие турниры -->
            <section class="upcoming-tournaments">
                <h2 class="section-title">Активные турниры</h2>
                <div class="tournaments-carousel" id="active-tournaments">
                    <!-- Турниры будут загружены через JavaScript -->
                </div>
            </section>

            <!-- Список всех команд из топ-6 лиг -->
            <section class="features">
                <h2 class="section-title">Команды топ-6 лиг</h2>
                <div class="league-groups" id="all-teams">
                    <!-- Команды будут загружены через JavaScript -->
                </div>
            </section>

            <!-- Инструкция для iOS -->
            <section class="ios-instruction">
                <h3>Как добавить сайт на главный экран iPhone (как приложение)</h3>
                <ol>
                    <li>Откройте сайт в браузере Safari</li>
                    <li>Нажмите кнопку "Поделиться" (квадрат со стрелкой вверх)</li>
                    <li>Прокрутите меню вниз и выберите "На экран Домой"</li>
                    <li>Нажмите "Добавить" в правом верхнем углу</li>
                    <li>Теперь иконка приложения появится на вашем домашнем экране</li>
                </ol>
            </section>
        </div>

        <!-- Страница турниров -->
        <div id="tournaments-page" class="page">
            <section class="hero">
                <div class="hero-content">
                    <h2>Турниры FC25</h2>
                    <p>Выберите турнир для участия или просмотра информации</p>
                </div>
                <div class="hero-image">
                    <img src="https://media.contentapi.ea.com/content/dam/ea/fifa/fifa-23/ultimate-team/common/fut23-competitive-featured-image-16x9.jpg.adapt.crop16x9.1023w.jpg" alt="Турниры FC25">
                </div>
            </section>

            <section class="upcoming-tournaments">
                <h2 class="section-title">Доступные турниры</h2>
                <div class="tournaments-carousel" id="available-tournaments">
                    <!-- Турниры будут загружены через JavaScript -->
                </div>
            </section>

            <section class="features">
                <h2 class="section-title">Типы турниров</h2>
                <div class="features-grid">
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-crown"></i>
                        </div>
                        <h3>Кубковые</h3>
                        <p>Олимпийская система с выбыванием после поражения</p>
                    </div>
                    
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-trophy"></i>
                        </div>
                        <h3>Лиги</h3>
                        <p>Круговая система с играми каждый против каждого</p>
                    </div>
                    
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-bolt"></i>
                        </div>
                        <h3>Быстрые</h3>
                        <p>Турниры с укороченным временем матча</p>
                    </div>
                    
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-users"></i>
                        </div>
                        <h3>Командные</h3>
                        <p>Турниры для команд из 2-5 игроков</p>
                    </div>
                </div>
            </section>
        </div>

        <!-- Страница профиля -->
        <div id="profile-page" class="page">
            <section class="hero">
                <div class="hero-content">
                    <div class="user-info">
                        <img src="https://cdn-icons-png.flaticon.com/512/3135/3135715.png" alt="Аватар пользователя" class="user-avatar" id="profile-avatar" style="width: 120px; height: 120px;">
                        <h2 id="profile-name">Игрок</h2>
                        <div class="user-rating">
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star-half-alt"></i>
                            <i class="far fa-star"></i>
                            <span id="profile-rating">(0.0)</span>
                        </div>
                        <p id="profile-email"></p>
                    </div>
                    <div class="profile-stats" style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-top: 20px;">
                        <div>
                            <h3 id="profile-matches">0</h3>
                            <p>Матчей</p>
                        </div>
                        <div>
                            <h3 id="profile-wins">0</h3>
                            <p>Побед</p>
                        </div>
                        <div>
                            <h3 id="profile-winrate">0%</h3>
                            <p>Win rate</p>
                        </div>
                    </div>
                </div>
                <div class="hero-image">
                    <img src="https://media.contentapi.ea.com/content/dam/ea/fifa/fifa-23/ultimate-team/common/fut23-stadium-featured-image-16x9.jpg.adapt.crop16x9.1023w.jpg" alt="Профиль игрока">
                </div>
            </section>

            <section class="features" id="admin-section" style="display: none;">
                <h2 class="section-title">Админ панель</h2>
                <div class="admin-actions">
                    <button class="btn btn-primary" id="create-tournament-btn"><i class="fas fa-plus"></i> Создать турнир</button>
                    <button class="btn btn-danger" id="delete-tournament-btn"><i class="fas fa-trash"></i> Удалить турнир</button>
                    <button class="btn btn-success" id="draw-tournament-btn"><i class="fas fa-random"></i> Жеребьевка</button>
                </div>
            </section>

            <section class="features">
                <h2 class="section-title">Мои турниры</h2>
                <div class="tournaments-carousel" id="user-tournaments">
                    <!-- Турниры пользователя будут загружены через JavaScript -->
                </div>
            </section>

            <section class="features" id="user-matches-section">
                <h2 class="section-title">Мои матчи</h2>
                <div id="user-matches">
                    <!-- Матчи пользователя будут загружены через JavaScript -->
                </div>
            </section>

            <section class="standings" id="tournament-standings" style="display: none;">
                <h3>Турнирная таблица</h3>
                <table id="standings-table">
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Команда</th>
                            <th>И</th>
                            <th>В</th>
                            <th>Н</th>
                            <th>П</th>
                            <th>ГЗ</th>
                            <th>ГП</th>
                            <th>РГ</th>
                            <th>О</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Данные таблицы будут загружены через JavaScript -->
                    </tbody>
                </table>
            </section>
        </div>

        <!-- Страница входа -->
        <div id="login-page" class="page">
            <section class="hero">
                <div class="hero-content">
                    <h2>Вход в систему</h2>
                    <p>Войдите в свой аккаунт для участия в турнирах</p>
                    
                    <form id="login-form" class="form-container">
                        <div class="form-group">
                            <label for="login-email">Email</label>
                            <input type="email" id="login-email" required placeholder="Ваш email">
                        </div>
                        <div class="form-group">
                            <label for="login-password">Пароль</label>
                            <input type="password" id="login-password" required placeholder="Ваш пароль">
                        </div>
                        <div class="form-actions">
                            <button type="button" class="btn btn-secondary" id="cancel-login">Отмена</button>
                            <button type="submit" class="btn btn-primary">Войти</button>
                        </div>
                        <p style="margin-top: 1rem; text-align: center;">
                            Нет аккаунта? <a href="#" id="show-register" style="color: #ff6b00;">Зарегистрируйтесь</a>
                        </p>
                    </form>
                </div>
                <div class="hero-image">
                    <img src="https://media.contentapi.ea.com/content/dam/ea/fifa/fifa-23/ultimate-team/common/fut23-settings-featured-image-16x9.jpg.adapt.crop16x9.1023w.jpg" alt="Вход в систему">
                </div>
            </section>
        </div>
    </main>

    <!-- Подвал сайта -->
    <footer>
        <div class="footer-content">
            <div class="footer-section">
                <h4>FC25 Турниры</h4>
                <p>Лучшая платформа для онлайн-соревнований по FIFA</p>
                <div class="social-links">
                    <a href="#"><i class="fab fa-telegram"></i></a>
                    <a href="#"><i class="fab fa-vk"></i></a>
                    <a href="#"><i class="fab fa-youtube"></i></a>
                </div>
            </div>
            
            <div class="footer-section">
                <h4>Навигация</h4>
                <ul>
                    <li><a href="#" data-page="home">Главная</a></li>
                    <li><a href="#" data-page="tournaments">Турниры</a></li>
                    <li><a href="#">Правила</a></li>
                    <li><a href="#">FAQ</a></li>
                </ul>
            </div>
            
            <div class="footer-section">
                <h4>Контакты</h4>
                <p><i class="fas fa-envelope"></i> support@fc25tournaments.com</p>
                <p><i class="fab fa-telegram"></i> @fc25_support</p>
                <p><i class="fas fa-phone"></i> +7 (123) 456-78-90</p>
            </div>
        </div>
        
        <div class="copyright">
            <p>&copy; 2023 FC25 Турниры. Все права защищены.</p>
        </div>
    </footer>

    <!-- Модальное окно регистрации -->
    <div class="modal" id="register-modal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h2 style="margin-bottom: 1.5rem;">Регистрация</h2>
            <form id="register-form">
                <div class="form-group">
                    <label for="register-username">Имя пользователя</label>
                    <input type="text" id="register-username" required placeholder="Придумайте никнейм">
                </div>
                <div class="form-group">
                    <label for="register-email">Email</label>
                    <input type="email" id="register-email" required placeholder="Ваш email">
                </div>
                <div class="form-group">
                    <label for="register-password">Пароль</label>
                    <input type="password" id="register-password" required placeholder="Придумайте пароль">
                </div>
                <div class="form-group">
                    <label for="register-confirm">Подтвердите пароль</label>
                    <input type="password" id="register-confirm" required placeholder="Повторите пароль">
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" id="cancel-register">Отмена</button>
                    <button type="submit" class="btn btn-primary">Зарегистрироваться</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Модальное окно турнира -->
    <div class="modal" id="tournament-modal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h2 id="tournament-modal-title" style="margin-bottom: 1rem;">Название турнира</h2>
            <img id="tournament-modal-image" src="" alt="Турнир" style="width: 100%; height: 200px; object-fit: cover; border-radius: 8px; margin-bottom: 1rem;">
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1.5rem;">
                <div>
                    <h4><i class="far fa-calendar-alt"></i> Даты</h4>
                    <p id="tournament-dates">15-30 декабря</p>
                </div>
                <div>
                    <h4><i class="fas fa-users"></i> Участники</h4>
                    <p id="tournament-participants">0/0</p>
                </div>
                <div>
                    <h4><i class="fas fa-trophy"></i> Призовой фонд</h4>
                    <p id="tournament-prize">0$</p>
                </div>
                <div>
                    <h4><i class="fas fa-signal"></i> Уровень</h4>
                    <p id="tournament-level">Все уровни</p>
                </div>
            </div>
            
            <h4 style="margin-bottom: 0.5rem;">Описание</h4>
            <p id="tournament-description" style="margin-bottom: 1.5rem;">
                Описание турнира будет здесь.
            </p>
            
            <div id="tournament-teams-section" style="margin-bottom: 1.5rem; display: none;">
                <h4 style="margin-bottom: 0.5rem;">Выберите команду</h4>
                <div class="league-groups" id="tournament-teams">
                    <!-- Команды будут загружены через JavaScript -->
                </div>
            </div>
            
            <div class="form-actions">
                <button type="button" class="btn btn-secondary" id="close-tournament-modal">Закрыть</button>
                <button type="button" class="btn btn-primary" id="join-tournament-btn">Участвовать</button>
                <button type="button" class="btn btn-danger" id="leave-tournament-btn" style="display: none;">Покинуть турнир</button>
                <button type="button" class="btn btn-success" id="admin-edit-btn" style="display: none;">Редактировать</button>
            </div>
        </div>
    </div>

    <!-- Модальное окно создания/редактирования турнира -->
    <div class="modal" id="edit-tournament-modal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h2 id="edit-tournament-title" style="margin-bottom: 1.5rem;">Создать турнир</h2>
            <form id="edit-tournament-form">
                <div class="form-group">
                    <label for="tournament-name">Название турнира</label>
                    <input type="text" id="tournament-name" required placeholder="Название турнира">
                </div>
                <div class="form-group">
                    <label for="tournament-image">Ссылка на изображение</label>
                    <input type="text" id="tournament-image" placeholder="URL изображения">
                </div>
                <div class="form-group">
                    <label for="tournament-start">Дата начала</label>
                    <input type="date" id="tournament-start" required>
                </div>
                <div class="form-group">
                    <label for="tournament-end">Дата окончания</label>
                    <input type="date" id="tournament-end" required>
                </div>
                <div class="form-group">
                    <label for="tournament-prize">Призовой фонд</label>
                    <input type="text" id="tournament-prize" placeholder="Например: 1000$">
                </div>
                <div class="form-group">
                    <label for="tournament-level">Уровень игроков</label>
                    <select id="tournament-level" required>
                        <option value="Все уровни">Все уровни</option>
                        <option value="Новичок">Новичок</option>
                        <option value="Любитель">Любитель</option>
                        <option value="Профессионал">Профессионал</option>
                        <option value="Легенда">Легенда</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="tournament-description">Описание турнира</label>
                    <textarea id="tournament-description" required placeholder="Правила и описание турнира"></textarea>
                </div>
                <div class="form-group">
                    <label for="tournament-type">Тип турнира</label>
                    <select id="tournament-type" required>
                        <option value="Кубок">Кубок (олимпийская система)</option>
                        <option value="Лига">Лига (круговая система)</option>
                        <option value="Группы+Плейофф">Группы + Плейофф</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="tournament-max-teams">Максимальное количество участников</label>
                    <input type="number" id="tournament-max-teams" min="2" value="16">
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" id="cancel-edit-tournament">Отмена</button>
                    <button type="submit" class="btn btn-primary" id="save-tournament-btn">Сохранить</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Модальное окно матча -->
    <div class="modal" id="match-modal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h2 id="match-modal-title" style="margin-bottom: 1rem;">Результат матча</h2>
            
            <div class="match-teams" style="justify-content: center; gap: 20px; margin-bottom: 1.5rem;">
                <div class="match-team">
                    <img id="match-team1-logo" src="" class="match-team-logo">
                    <span id="match-team1-name"></span>
                </div>
                <div class="match-score">
                    <input type="number" id="match-team1-score" min="0" style="width: 50px; text-align: center;">
                    <span>:</span>
                    <input type="number" id="match-team2-score" min="0" style="width: 50px; text-align: center;">
                </div>
                <div class="match-team">
                    <img id="match-team2-logo" src="" class="match-team-logo">
                    <span id="match-team2-name"></span>
                </div>
            </div>
            
            <div class="form-group">
                <label for="match-comment">Комментарий (необязательно)</label>
                <textarea id="match-comment" placeholder="Опишите ход матча"></textarea>
            </div>
            
            <div id="match-status" class="match-status status-pending" style="margin-bottom: 1rem;">Ожидает подтверждения</div>
            
            <div class="form-actions">
                <button type="button" class="btn btn-secondary" id="close-match-modal">Закрыть</button>
                <button type="button" class="btn btn-primary" id="submit-match-btn">Отправить результат</button>
                <button type="button" class="btn btn-success" id="confirm-match-btn" style="display: none;">Подтвердить результат</button>
                <button type="button" class="btn btn-danger" id="reject-match-btn" style="display: none;">Отклонить результат</button>
            </div>
        </div>
    </div>

    <!-- Модальное окно удаления турнира -->
    <div class="modal" id="delete-tournament-modal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h2 style="margin-bottom: 1.5rem;">Удалить турнир</h2>
            <div class="form-group">
                <label for="select-tournament-to-delete">Выберите турнир для удаления</label>
                <select id="select-tournament-to-delete" class="form-control">
                    <!-- Турниры будут загружены через JavaScript -->
                </select>
            </div>
            <div class="form-actions">
                <button type="button" class="btn btn-secondary" id="cancel-delete-tournament">Отмена</button>
                <button type="button" class="btn btn-danger" id="confirm-delete-tournament">Удалить</button>
            </div>
        </div>
    </div>

    <!-- Подключение JavaScript -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Элементы страниц
            const pages = {
                home: document.getElementById('home-page'),
                tournaments: document.getElementById('tournaments-page'),
                profile: document.getElementById('profile-page'),
                login: document.getElementById('login-page')
            };
            
            // Навигационные ссылки
            const navLinks = document.querySelectorAll('nav a[data-page]');
            const authText = document.getElementById('auth-text');
            
            // Модальные окна
            const registerModal = document.getElementById('register-modal');
            const tournamentModal = document.getElementById('tournament-modal');
            const editTournamentModal = document.getElementById('edit-tournament-modal');
            const matchModal = document.getElementById('match-modal');
            const deleteTournamentModal = document.getElementById('delete-tournament-modal');
            
            // Кнопки
            const registerBtn = document.getElementById('register-btn');
            const showRegisterLink = document.getElementById('show-register');
            const cancelRegisterBtn = document.getElementById('cancel-register');
            const closeRegisterModal = document.querySelector('#register-modal .close-modal');
            const cancelLoginBtn = document.getElementById('cancel-login');
            const closeTournamentModal = document.querySelector('#tournament-modal .close-modal');
            const closeTournamentBtn = document.getElementById('close-tournament-modal');
            const joinTournamentBtn = document.getElementById('join-tournament-btn');
            const leaveTournamentBtn = document.getElementById('leave-tournament-btn');
            const adminEditBtn = document.getElementById('admin-edit-btn');
            const createTournamentBtn = document.getElementById('create-tournament-btn');
            const deleteTournamentBtn = document.getElementById('delete-tournament-btn');
            const drawTournamentBtn = document.getElementById('draw-tournament-btn');
            const cancelEditTournamentBtn = document.getElementById('cancel-edit-tournament');
            const saveTournamentBtn = document.getElementById('save-tournament-btn');
            const closeMatchModal = document.querySelector('#match-modal .close-modal');
            const submitMatchBtn = document.getElementById('submit-match-btn');
            const confirmMatchBtn = document.getElementById('confirm-match-btn');
            const rejectMatchBtn = document.getElementById('reject-match-btn');
            const cancelDeleteTournamentBtn = document.getElementById('cancel-delete-tournament');
            const confirmDeleteTournamentBtn = document.getElementById('confirm-delete-tournament');
            
            // Формы
            const loginForm = document.getElementById('login-form');
            const registerForm = document.getElementById('register-form');
            const editTournamentForm = document.getElementById('edit-tournament-form');
            
            // Элементы профиля
            const profileName = document.getElementById('profile-name');
            const profileEmail = document.getElementById('profile-email');
            const profileAvatar = document.getElementById('profile-avatar');
            const profileRating = document.getElementById('profile-rating');
            const profileMatches = document.getElementById('profile-matches');
            const profileWins = document.getElementById('profile-wins');
            const profileWinrate = document.getElementById('profile-winrate');
            const adminSection = document.getElementById('admin-section');
            const standingsSection = document.getElementById('tournament-standings');
            const standingsTable = document.getElementById('standings-table').querySelector('tbody');
            
            // Списки турниров
            const activeTournamentsContainer = document.getElementById('active-tournaments');
            const availableTournamentsContainer = document.getElementById('available-tournaments');
            const userTournamentsContainer = document.getElementById('user-tournaments');
            
            // Команды
            const teamsContainer = document.getElementById('tournament-teams');
            const teamsSection = document.getElementById('tournament-teams-section');
            const allTeamsContainer = document.getElementById('all-teams');
            
            // Матчи
            const userMatchesContainer = document.getElementById('user-matches');
            
            // Данные приложения
            const teams = [
                { id: 1, name: 'Реал Мадрид', logo: 'https://cdn.freebiesupply.com/logos/large/2x/real-madrid-logo-png-transparent.png', league: 'La Liga' },
                { id: 2, name: 'Барселона', logo: 'https://cdn.freebiesupply.com/logos/large/2x/fc-barcelona-logo-png-transparent.png', league: 'La Liga' },
                { id: 3, name: 'Атлетико Мадрид', logo: 'https://cdn.freebiesupply.com/logos/large/2x/atletico-madrid-logo-png-transparent.png', league: 'La Liga' },
                { id: 4, name: 'Севилья', logo: 'https://cdn.freebiesupply.com/logos/large/2x/sevilla-fc-logo-png-transparent.png', league: 'La Liga' },
                { id: 5, name: 'Валенсия', logo: 'https://cdn.freebiesupply.com/logos/large/2x/valencia-cf-logo-png-transparent.png', league: 'La Liga' },
                { id: 6, name: 'Вильярреал', logo: 'https://cdn.freebiesupply.com/logos/large/2x/villarreal-cf-logo-png-transparent.png', league: 'La Liga' },
                { id: 7, name: 'Реал Сосьедад', logo: 'https://cdn.freebiesupply.com/logos/large/2x/real-sociedad-logo-png-transparent.png', league: 'La Liga' },
                { id: 8, name: 'Атлетик Бильбао', logo: 'https://cdn.freebiesupply.com/logos/large/2x/athletic-bilbao-logo-png-transparent.png', league: 'La Liga' },
                { id: 9, name: 'Бетис', logo: 'https://cdn.freebiesupply.com/logos/large/2x/real-betis-logo-png-transparent.png', league: 'La Liga' },
                { id: 10, name: 'Сельта', logo: 'https://cdn.freebiesupply.com/logos/large/2x/celta-vigo-logo-png-transparent.png', league: 'La Liga' },
                
                { id: 11, name: 'Манчестер Сити', logo: 'https://cdn.freebiesupply.com/logos/large/2x/manchester-city-logo-png-transparent.png', league: 'Premier League' },
                { id: 12, name: 'Ливерпуль', logo: 'https://cdn.freebiesupply.com/logos/large/2x/liverpool-fc-logo-png-transparent.png', league: 'Premier League' },
                { id: 13, name: 'Челси', logo: 'https://cdn.freebiesupply.com/logos/large/2x/chelsea-fc-logo-png-transparent.png', league: 'Premier League' },
                { id: 14, name: 'Манчестер Юнайтед', logo: 'https://cdn.freebiesupply.com/logos/large/2x/manchester-united-logo-png-transparent.png', league: 'Premier League' },
                { id: 15, name: 'Арсенал', logo: 'https://cdn.freebiesupply.com/logos/large/2x/arsenal-logo-png-transparent.png', league: 'Premier League' },
                { id: 16, name: 'Тоттенхэм', logo: 'https://cdn.freebiesupply.com/logos/large/2x/tottenham-hotspur-logo-png-transparent.png', league: 'Premier League' },
                { id: 17, name: 'Лестер Сити', logo: 'https://cdn.freebiesupply.com/logos/large/2x/leicester-city-fc-logo-png-transparent.png', league: 'Premier League' },
                { id: 18, name: 'Вест Хэм', logo: 'https://cdn.freebiesupply.com/logos/large/2x/west-ham-united-logo-png-transparent.png', league: 'Premier League' },
                { id: 19, name: 'Вулверхэмптон', logo: 'https://cdn.freebiesupply.com/logos/large/2x/wolverhampton-wanderers-logo-png-transparent.png', league: 'Premier League' },
                { id: 20, name: 'Эвертон', logo: 'https://cdn.freebiesupply.com/logos/large/2x/everton-fc-logo-png-transparent.png', league: 'Premier League' },
                
                { id: 21, name: 'Бавария', logo: 'https://cdn.freebiesupply.com/logos/large/2x/bayern-munich-logo-png-transparent.png', league: 'Bundesliga' },
                { id: 22, name: 'Боруссия Дортмунд', logo: 'https://cdn.freebiesupply.com/logos/large/2x/borussia-dortmund-logo-png-transparent.png', league: 'Bundesliga' },
                { id: 23, name: 'РБ Лейпциг', logo: 'https://cdn.freebiesupply.com/logos/large/2x/rb-leipzig-logo-png-transparent.png', league: 'Bundesliga' },
                { id: 24, name: 'Байер Леверкузен', logo: 'https://cdn.freebiesupply.com/logos/large/2x/bayer-leverkusen-logo-png-transparent.png', league: 'Bundesliga' },
                { id: 25, name: 'Вольфсбург', logo: 'https://cdn.freebiesupply.com/logos/large/2x/vfl-wolfsburg-logo-png-transparent.png', league: 'Bundesliga' },
                { id: 26, name: 'Айнтрахт Франкфурт', logo: 'https://cdn.freebiesupply.com/logos/large/2x/eintracht-frankfurt-logo-png-transparent.png', league: 'Bundesliga' },
                { id: 27, name: 'Боруссия Мёнхенгладбах', logo: 'https://cdn.freebiesupply.com/logos/large/2x/borussia-monchengladbach-logo-png-transparent.png', league: 'Bundesliga' },
                { id: 28, name: 'Хоффенхайм', logo: 'https://cdn.freebiesupply.com/logos/large/2x/tsg-1899-hoffenheim-logo-png-transparent.png', league: 'Bundesliga' },
                { id: 29, name: 'Штутгарт', logo: 'https://cdn.freebiesupply.com/logos/large/2x/vfb-stuttgart-logo-png-transparent.png', league: 'Bundesliga' },
                { id: 30, name: 'Герта', logo: 'https://cdn.freebiesupply.com/logos/large/2x/hertha-berlin-logo-png-transparent.png', league: 'Bundesliga' },
                
                { id: 31, name: 'ПСЖ', logo: 'https://cdn.freebiesupply.com/logos/large/2x/paris-saint-germain-logo-png-transparent.png', league: 'Ligue 1' },
                { id: 32, name: 'Марсель', logo: 'https://cdn.freebiesupply.com/logos/large/2x/olympique-de-marseille-logo-png-transparent.png', league: 'Ligue 1' },
                { id: 33, name: 'Лион', logo: 'https://cdn.freebiesupply.com/logos/large/2x/olympique-lyonnais-logo-png-transparent.png', league: 'Ligue 1' },
                { id: 34, name: 'Монако', logo: 'https://cdn.freebiesupply.com/logos/large/2x/as-monaco-logo-png-transparent.png', league: 'Ligue 1' },
                { id: 35, name: 'Лилль', logo: 'https://cdn.freebiesupply.com/logos/large/2x/lille-osc-logo-png-transparent.png', league: 'Ligue 1' },
                { id: 36, name: 'Ренн', logo: 'https://cdn.freebiesupply.com/logos/large/2x/stade-rennais-fc-logo-png-transparent.png', league: 'Ligue 1' },
                { id: 37, name: 'Ницца', logo: 'https://cdn.freebiesupply.com/logos/large/2x/ogc-nice-logo-png-transparent.png', league: 'Ligue 1' },
                { id: 38, name: 'Бордо', logo: 'https://cdn.freebiesupply.com/logos/large/2x/fc-girondins-de-bordeaux-logo-png-transparent.png', league: 'Ligue 1' },
                { id: 39, name: 'Сент-Этьен', logo: 'https://cdn.freebiesupply.com/logos/large/2x/as-saint-etienne-logo-png-transparent.png', league: 'Ligue 1' },
                { id: 40, name: 'Нант', logo: 'https://cdn.freebiesupply.com/logos/large/2x/fc-nantes-logo-png-transparent.png', league: 'Ligue 1' },
                
                { id: 41, name: 'Ювентус', logo: 'https://cdn.freebiesupply.com/logos/large/2x/juventus-logo-png-transparent.png', league: 'Serie A' },
                { id: 42, name: 'Милан', logo: 'https://cdn.freebiesupply.com/logos/large/2x/ac-milan-logo-png-transparent.png', league: 'Serie A' },
                { id: 43, name: 'Интер', logo: 'https://cdn.freebiesupply.com/logos/large/2x/inter-milan-logo-png-transparent.png', league: 'Serie A' },
                { id: 44, name: 'Наполи', logo: 'https://cdn.freebiesupply.com/logos/large/2x/napoli-logo-png-transparent.png', league: 'Serie A' },
                { id: 45, name: 'Рома', logo: 'https://cdn.freebiesupply.com/logos/large/2x/as-roma-logo-png-transparent.png', league: 'Serie A' },
                { id: 46, name: 'Лацио', logo: 'https://cdn.freebiesupply.com/logos/large/2x/lazio-logo-png-transparent.png', league: 'Serie A' },
                { id: 47, name: 'Аталанта', logo: 'https://cdn.freebiesupply.com/logos/large/2x/atalanta-bc-logo-png-transparent.png', league: 'Serie A' },
                { id: 48, name: 'Фиорентина', logo: 'https://cdn.freebiesupply.com/logos/large/2x/acf-fiorentina-logo-png-transparent.png', league: 'Serie A' },
                { id: 49, name: 'Сассуоло', logo: 'https://cdn.freebiesupply.com/logos/large/2x/us-sassuolo-logo-png-transparent.png', league: 'Serie A' },
                { id: 50, name: 'Торино', logo: 'https://cdn.freebiesupply.com/logos/large/2x/torino-fc-logo-png-transparent.png', league: 'Serie A' }
            ];
            
            let tournaments = [
                {
                    id: 1,
                    name: 'FC25 Winter Cup',
                    image: 'https://media.contentapi.ea.com/content/dam/ea/fifa/fifa-23/ultimate-team/common/fut23-tournament-featured-image-16x9.jpg.adapt.crop16x9.1023w.jpg',
                    startDate: '2023-12-15',
                    endDate: '2023-12-30',
                    prize: '1000$',
                    level: 'Профессионал',
                    description: 'Ежегодный зимний кубок для игроков среднего уровня. Турнир проводится по олимпийской системе с выбыванием после поражения. Каждый матч состоит из двух таймов по 6 минут. В случае ничьи в основное время - серия пенальти.',
                    type: 'Кубок',
                    maxTeams: 32,
                    participants: [],
                    matches: [],
                    status: 'active'
                },
                {
                    id: 2,
                    name: 'FC25 Pro League',
                    image: 'https://media.contentapi.ea.com/content/dam/ea/fifa/fifa-23/ultimate-team/common/fut23-competitive-featured-image-16x9.jpg.adapt.crop16x9.1023w.jpg',
                    startDate: '2024-01-05',
                    endDate: '2024-01-20',
                    prize: '2500$',
                    level: 'Легенда',
                    description: 'Профессиональная лига для опытных игроков. Круговая система с играми каждый против каждого. Топ-8 выходит в плей-офф. Матчи состоят из двух таймов по 8 минут. В случае ничьи в основное время - дополнительное время и пенальти.',
                    type: 'Лига',
                    maxTeams: 64,
                    participants: [],
                    matches: [],
                    status: 'upcoming'
                },
                {
                    id: 3,
                    name: 'FC25 Open Tournament',
                    image: 'https://media.contentapi.ea.com/content/dam/ea/fifa/fifa-23/ultimate-team/common/fut23-friendlies-featured-image-16x9.jpg.adapt.crop16x9.1023w.jpg',
                    startDate: '2024-02-01',
                    endDate: '2024-02-15',
                    prize: 'Бесплатный вход',
                    level: 'Все уровни',
                    description: 'Открытый турнир для игроков любого уровня. Отличная возможность попробовать свои силы. Групповая стадия с последующим плей-офф. Матчи состоят из двух таймов по 4 минуты. В случае ничьи - сразу пенальти.',
                    type: 'Группы+Плейофф',
                    maxTeams: 128,
                    participants: [],
                    matches: [],
                    status: 'upcoming'
                }
            ];
            
            let matches = [];
            let currentUser = null;
            let currentTournament = null;
            let currentMatch = null;
            let isAdmin = false;
            let selectedTeam = null;
            let editingTournamentId = null;
            
            // Инициализация приложения
            function init() {
                // Проверяем, есть ли сохраненные данные в localStorage
                const savedUser = localStorage.getItem('currentUser');
                const savedTournaments = localStorage.getItem('tournaments');
                const savedMatches = localStorage.getItem('matches');
                
                if (savedUser) {
                    currentUser = JSON.parse(savedUser);
                    updateProfile();
                    authText.textContent = 'Выйти';
                }
                
                if (savedTournaments) {
                    tournaments = JSON.parse(savedTournaments);
                }
                
                if (savedMatches) {
                    matches = JSON.parse(savedMatches);
                }
                
                // Проверяем админские права (в реальном приложении это делалось бы на сервере)
                if (currentUser && currentUser.email === 'admin@fc25.com') {
                    isAdmin = true;
                    adminSection.style.display = 'block';
                }
                
                renderTournaments();
                renderAllTeams();
                showPage('home');
                
                // Если пользователь авторизован, обновляем его турниры и матчи
                if (currentUser) {
                    renderUserTournaments();
                    renderUserMatches();
                }
            }
            
            // Показать страницу
            function showPage(pageId) {
                // Скрыть все страницы
                Object.values(pages).forEach(page => {
                    page.classList.remove('active');
                });
                
                // Показать выбранную страницу
                if (pages[pageId]) {
                    pages[pageId].classList.add('active');
                } else {
                    pages.home.classList.add('active');
                }
                
                // Обновить активную ссылку в навигации
                navLinks.forEach(link => {
                    if (link.getAttribute('data-page') === pageId) {
                        link.classList.add('active');
                    } else {
                        link.classList.remove('active');
                    }
                });
                
                // Если показываем профиль, но пользователь не авторизован - показать страницу входа
                if (pageId === 'profile' && !currentUser) {
                    showPage('login');
                }
            }
            
            // Обновить профиль пользователя
            function updateProfile() {
                if (!currentUser) return;
                
                profileName.textContent = currentUser.username;
                profileEmail.textContent = currentUser.email;
                
                // Рассчитываем статистику
                const userMatches = matches.filter(m => 
                    m.player1.id === currentUser.id || m.player2.id === currentUser.id
                );
                
                const completedMatches = userMatches.filter(m => m.status === 'completed');
                const wins = completedMatches.filter(m => 
                    (m.player1.id === currentUser.id && m.score1 > m.score2) || 
                    (m.player2.id === currentUser.id && m.score2 > m.score1)
                ).length;
                
                const winRate = completedMatches.length > 0 
                    ? Math.round((wins / completedMatches.length) * 100) 
                    : 0;
                
                // Обновляем данные в профиле
                profileMatches.textContent = completedMatches.length;
                profileWins.textContent = wins;
                profileWinrate.textContent = `${winRate}%`;
                
                // Рассчитываем рейтинг (простая формула)
                const rating = completedMatches.length > 0 
                    ? (wins / completedMatches.length) * 5 
                    : 0;
                
                profileRating.textContent = `(${rating.toFixed(1)})`;
                
                // Обновляем звезды рейтинга
                const starsContainer = document.querySelector('.user-rating');
                starsContainer.innerHTML = '';
                
                const fullStars = Math.floor(rating);
                const hasHalfStar = rating % 1 >= 0.5;
                
                for (let i = 0; i < 5; i++) {
                    if (i < fullStars) {
                        starsContainer.innerHTML += '<i class="fas fa-star"></i>';
                    } else if (i === fullStars && hasHalfStar) {
                        starsContainer.innerHTML += '<i class="fas fa-star-half-alt"></i>';
                    } else {
                        starsContainer.innerHTML += '<i class="far fa-star"></i>';
                    }
                }
                
                starsContainer.innerHTML += ` <span>(${rating.toFixed(1)})</span>`;
            }
            
            // Отобразить турниры
            function renderTournaments() {
                // Активные турниры
                const activeTournaments = tournaments.filter(t => t.status === 'active');
                activeTournamentsContainer.innerHTML = activeTournaments.map(tournament => `
                    <div class="tournament-card">
                        <img src="${tournament.image}" alt="${tournament.name}" class="tournament-image">
                        <div class="tournament-info">
                            <h3>${tournament.name}</h3>
                            <div class="tournament-meta">
                                <p><i class="far fa-calendar-alt"></i> ${formatDate(tournament.startDate)} - ${formatDate(tournament.endDate)}</p>
                                <p><i class="fas fa-users"></i> ${tournament.participants.length}/${tournament.maxTeams} участников</p>
                                <p><i class="fas fa-coins"></i> ${tournament.prize}</p>
                            </div>
                            <button class="btn btn-primary" data-tournament-id="${tournament.id}">Подробнее</button>
                        </div>
                    </div>
                `).join('');
                
                // Доступные турниры (активные и upcoming)
                const availableTournaments = tournaments.filter(t => t.status !== 'completed');
                availableTournamentsContainer.innerHTML = availableTournaments.map(tournament => `
                    <div class="tournament-card">
                        <img src="${tournament.image}" alt="${tournament.name}" class="tournament-image">
                        <div class="tournament-info">
                            <h3>${tournament.name}</h3>
                            <div class="tournament-meta">
                                <p><i class="far fa-calendar-alt"></i> ${formatDate(tournament.startDate)} - ${formatDate(tournament.endDate)}</p>
                                <p><i class="fas fa-users"></i> ${tournament.participants.length}/${tournament.maxTeams} участников</p>
                                <p><i class="fas fa-coins"></i> ${tournament.prize}</p>
                                <p><i class="fas fa-signal"></i> ${tournament.level}</p>
                            </div>
                            <button class="btn btn-primary" data-tournament-id="${tournament.id}">Подробнее</button>
                        </div>
                    </div>
                `).join('');
                
                // Навешиваем обработчики на кнопки
                document.querySelectorAll('[data-tournament-id]').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const tournamentId = parseInt(this.getAttribute('data-tournament-id'));
                        showTournamentModal(tournamentId);
                    });
                });
            }
            
            // Отобразить все команды из топ-6 лиг
            function renderAllTeams() {
                // Группируем команды по лигам
                const leagues = {};
                teams.forEach(team => {
                    if (!leagues[team.league]) {
                        leagues[team.league] = [];
                    }
                    leagues[team.league].push(team);
                });
                
                // Создаем HTML для каждой лиги
                allTeamsContainer.innerHTML = '';
                for (const leagueName in leagues) {
                    const leagueTeams = leagues[leagueName];
                    const leagueId = leagueName.replace(/\s+/g, '-').toLowerCase();
                    
                    const leagueHTML = `
                        <div class="league-group">
                            <div class="league-title" data-league-id="${leagueId}">
                                <span>${leagueName}</span>
                                <i class="fas fa-chevron-down"></i>
                            </div>
                            <div class="league-teams" id="${leagueId}-all-teams">
                                ${leagueTeams.map(team => `
                                    <div class="team-card">
                                        <img src="${team.logo}" alt="${team.name}" class="team-logo" onerror="this.src='https://via.placeholder.com/50?text=No+Logo'">
                                        <div>${team.name}</div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    `;
                    
                    allTeamsContainer.innerHTML += leagueHTML;
                }
                
                // Навешиваем обработчики сворачивания/разворачивания лиг
                document.querySelectorAll('#all-teams .league-title').forEach(title => {
                    title.addEventListener('click', function() {
                        const leagueId = this.getAttribute('data-league-id');
                        const teamsContainer = document.getElementById(`${leagueId}-all-teams`);
                        this.classList.toggle('collapsed');
                        teamsContainer.classList.toggle('collapsed');
                    });
                });
            }
            
            // Отобразить турниры пользователя
            function renderUserTournaments() {
                if (!currentUser) return;
                
                const userTournaments = tournaments.filter(t => 
                    t.participants.some(p => p.id === currentUser.id)
                );
                
                userTournamentsContainer.innerHTML = userTournaments.map(tournament => `
                    <div class="tournament-card">
                        <img src="${tournament.image}" alt="${tournament.name}" class="tournament-image">
                        <div class="tournament-info">
                            <h3>${tournament.name}</h3>
                            <div class="tournament-meta">
                                <p><i class="far fa-calendar-alt"></i> ${formatDate(tournament.startDate)} - ${formatDate(tournament.endDate)}</p>
                                <p><i class="fas fa-users"></i> ${tournament.participants.length}/${tournament.maxTeams} участников</p>
                                <p><i class="fas fa-coins"></i> ${tournament.prize}</p>
                            </div>
                            <button class="btn btn-primary" data-tournament-id="${tournament.id}">Подробнее</button>
                        </div>
                    </div>
                `).join('');
                
                // Навешиваем обработчики на кнопки
                document.querySelectorAll('#user-tournaments [data-tournament-id]').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const tournamentId = parseInt(this.getAttribute('data-tournament-id'));
                        showTournamentModal(tournamentId);
                    });
                });
            }
            
            // Отобразить матчи пользователя
            function renderUserMatches() {
                if (!currentUser) return;
                
                const userMatches = matches.filter(m => 
                    m.player1.id === currentUser.id || m.player2.id === currentUser.id
                );
                
                userMatchesContainer.innerHTML = userMatches.map(match => {
                    const isPlayer1 = match.player1.id === currentUser.id;
                    const opponent = isPlayer1 ? match.player2 : match.player1;
                    const myScore = isPlayer1 ? match.score1 : match.score2;
                    const opponentScore = isPlayer1 ? match.score2 : match.score1;
                    
                    let statusBadge = '';
                    if (match.status === 'pending') {
                        statusBadge = '<span class="match-status status-pending">Ожидает подтверждения</span>';
                    } else if (match.status === 'completed') {
                        statusBadge = '<span class="match-status status-confirmed">Завершен</span>';
                    }
                    
                    return `
                        <div class="match-card" data-match-id="${match.id}">
                            <div class="match-teams">
                                <div class="match-team">
                                    <img src="${isPlayer1 ? match.player1.team.logo : match.player2.team.logo}" class="match-team-logo">
                                    <span>${isPlayer1 ? 'Вы' : opponent.username}</span>
                                </div>
                                <div class="match-score">
                                    ${myScore !== null ? myScore : '?'} : ${opponentScore !== null ? opponentScore : '?'}
                                </div>
                                <div class="match-team">
                                    <img src="${isPlayer1 ? match.player2.team.logo : match.player1.team.logo}" class="match-team-logo">
                                    <span>${isPlayer1 ? opponent.username : 'Вы'}</span>
                                </div>
                            </div>
                            ${statusBadge}
                            <button class="btn btn-secondary">Детали</button>
                        </div>
                    `;
                }).join('');
                
                // Навешиваем обработчики на кнопки
                document.querySelectorAll('#user-matches .match-card').forEach(card => {
                    card.addEventListener('click', function() {
                        const matchId = parseInt(this.getAttribute('data-match-id'));
                        showMatchModal(matchId);
                    });
                });
            }
            
            // Показать модальное окно турнира
            function showTournamentModal(tournamentId) {
                currentTournament = tournaments.find(t => t.id === tournamentId);
                if (!currentTournament) return;
                
                // Заполняем данные турнира
                document.getElementById('tournament-modal-title').textContent = currentTournament.name;
                document.getElementById('tournament-modal-image').src = currentTournament.image;
                document.getElementById('tournament-dates').textContent = `${formatDate(currentTournament.startDate)} - ${formatDate(currentTournament.endDate)}`;
                document.getElementById('tournament-participants').textContent = `${currentTournament.participants.length}/${currentTournament.maxTeams}`;
                document.getElementById('tournament-prize').textContent = currentTournament.prize;
                document.getElementById('tournament-level').textContent = currentTournament.level;
                document.getElementById('tournament-description').textContent = currentTournament.description;
                
                // Проверяем, участвует ли пользователь в турнире
                const isParticipant = currentUser && currentTournament.participants.some(p => p.id === currentUser.id);
                
                // Показываем список команд, если турнир активен и пользователь не участвует
                if (currentTournament.status === 'active' && !isParticipant && currentUser) {
                    renderTeamsForTournament();
                    teamsSection.style.display = 'block';
                } else {
                    teamsSection.style.display = 'none';
                }
                
                // Настраиваем кнопки
                joinTournamentBtn.style.display = isParticipant ? 'none' : 'inline-block';
                leaveTournamentBtn.style.display = isParticipant ? 'inline-block' : 'none';
                
                if (isAdmin) {
                    adminEditBtn.style.display = 'inline-block';
                } else {
                    adminEditBtn.style.display = 'none';
                }
                
                // Показываем турнирную таблицу для лиг
                if (currentTournament.type === 'Лига' && currentTournament.participants.length > 0) {
                    renderStandings();
                    standingsSection.style.display = 'block';
                } else {
                    standingsSection.style.display = 'none';
                }
                
                // Показываем модальное окно
                showModal(tournamentModal);
            }
            
            // Отобразить команды для выбора в турнире (с группировкой по лигам)
            function renderTeamsForTournament() {
                if (!currentTournament || !currentUser) return;
                
                // Получаем занятые команды в этом турнире
                const takenTeamIds = currentTournament.participants.map(p => p.team.id);
                
                // Группируем команды по лигам
                const leagues = {};
                teams.forEach(team => {
                    if (!leagues[team.league]) {
                        leagues[team.league] = [];
                    }
                    leagues[team.league].push(team);
                });
                
                // Создаем HTML для каждой лиги
                teamsContainer.innerHTML = '';
                for (const leagueName in leagues) {
                    const leagueTeams = leagues[leagueName];
                    const leagueId = leagueName.replace(/\s+/g, '-').toLowerCase();
                    
                    const leagueHTML = `
                        <div class="league-group">
                            <div class="league-title" data-league-id="${leagueId}">
                                <span>${leagueName}</span>
                                <i class="fas fa-chevron-down"></i>
                            </div>
                            <div class="league-teams" id="${leagueId}-teams">
                                ${leagueTeams.map(team => {
                                    const isTaken = takenTeamIds.includes(team.id);
                                    const isSelected = selectedTeam && selectedTeam.id === team.id;
                                    
                                    return `
                                        <div class="team-card ${isSelected ? 'selected' : ''} ${isTaken ? 'taken' : ''}" 
                                             data-team-id="${team.id}" ${isTaken ? 'title="Эта команда уже занята"' : ''}>
                                            <img src="${team.logo}" alt="${team.name}" class="team-logo" onerror="this.src='https://via.placeholder.com/50?text=No+Logo'">
                                            <div>${team.name}</div>
                                        </div>
                                    `;
                                }).join('')}
                            </div>
                        </div>
                    `;
                    
                    teamsContainer.innerHTML += leagueHTML;
                }
                
                // Навешиваем обработчики сворачивания/разворачивания лиг
                document.querySelectorAll('.league-title').forEach(title => {
                    title.addEventListener('click', function() {
                        const leagueId = this.getAttribute('data-league-id');
                        const teamsContainer = document.getElementById(`${leagueId}-teams`);
                        this.classList.toggle('collapsed');
                        teamsContainer.classList.toggle('collapsed');
                    });
                });
                
                // Навешиваем обработчики выбора команды
                document.querySelectorAll('.team-card:not(.taken)').forEach(card => {
                    card.addEventListener('click', function() {
                        const teamId = parseInt(this.getAttribute('data-team-id'));
                        selectedTeam = teams.find(t => t.id === teamId);
                        
                        // Снимаем выделение со всех карточек
                        document.querySelectorAll('.team-card').forEach(c => {
                            c.classList.remove('selected');
                        });
                        
                        // Выделяем выбранную карточку
                        this.classList.add('selected');
                    });
                });
            }
            
            // Отобразить турнирную таблицу
            function renderStandings() {
                if (!currentTournament || currentTournament.type !== 'Лига') return;
                
                // Создаем объект для хранения статистики команд
                const standings = {};
                
                // Инициализируем статистику для всех участников
                currentTournament.participants.forEach(participant => {
                    standings[participant.id] = {
                        participant: participant,
                        played: 0,
                        wins: 0,
                        draws: 0,
                        losses: 0,
                        goalsFor: 0,
                        goalsAgainst: 0,
                        points: 0
                    };
                });
                
                // Обрабатываем все матчи турнира
                matches.forEach(match => {
                    if (match.tournamentId === currentTournament.id && match.status === 'completed') {
                        const player1Id = match.player1.id;
                        const player2Id = match.player2.id;
                        
                        // Обновляем статистику для игрока 1
                        standings[player1Id].played++;
                        standings[player1Id].goalsFor += match.score1;
                        standings[player1Id].goalsAgainst += match.score2;
                        
                        // Обновляем статистику для игрока 2
                        standings[player2Id].played++;
                        standings[player2Id].goalsFor += match.score2;
                        standings[player2Id].goalsAgainst += match.score1;
                        
                        // Определяем результат матча
                        if (match.score1 > match.score2) {
                            standings[player1Id].wins++;
                            standings[player1Id].points += 3;
                            standings[player2Id].losses++;
                        } else if (match.score1 < match.score2) {
                            standings[player2Id].wins++;
                            standings[player2Id].points += 3;
                            standings[player1Id].losses++;
                        } else {
                            standings[player1Id].draws++;
                            standings[player2Id].draws++;
                            standings[player1Id].points += 1;
                            standings[player2Id].points += 1;
                        }
                    }
                });
                
                // Преобразуем объект в массив и сортируем по очкам
                const standingsArray = Object.values(standings);
                standingsArray.sort((a, b) => {
                    if (b.points !== a.points) return b.points - a.points;
                    const gdA = a.goalsFor - a.goalsAgainst;
                    const gdB = b.goalsFor - b.goalsAgainst;
                    if (gdB !== gdA) return gdB - gdA;
                    return b.goalsFor - a.goalsFor;
                });
                
                // Очищаем таблицу
                standingsTable.innerHTML = '';
                
                // Заполняем таблицу
                standingsArray.forEach((team, index) => {
                    const row = document.createElement('tr');
                    const goalDifference = team.goalsFor - team.goalsAgainst;
                    
                    row.innerHTML = `
                        <td>${index + 1}</td>
                        <td>
                            <img src="${team.participant.team.logo}" alt="${team.participant.team.name}" style="height: 20px; margin-right: 8px;" onerror="this.src='https://via.placeholder.com/20?text=No+Logo'">
                            ${team.participant.team.name}
                        </td>
                        <td>${team.played}</td>
                        <td>${team.wins}</td>
                        <td>${team.draws}</td>
                        <td>${team.losses}</td>
                        <td>${team.goalsFor}</td>
                        <td>${team.goalsAgainst}</td>
                        <td>${goalDifference > 0 ? '+' : ''}${goalDifference}</td>
                        <td><strong>${team.points}</strong></td>
                    `;
                    
                    standingsTable.appendChild(row);
                });
            }
            
            // Показать модальное окно матча
            function showMatchModal(matchId) {
                currentMatch = matches.find(m => m.id === matchId);
                if (!currentMatch) return;
                
                const isPlayer1 = currentUser && currentMatch.player1.id === currentUser.id;
                const isPlayer2 = currentUser && currentMatch.player2.id === currentUser.id;
                const isAdminView = isAdmin && !isPlayer1 && !isPlayer2;
                
                // Заполняем данные матча
                document.getElementById('match-modal-title').textContent = `Матч: ${currentMatch.player1.username} vs ${currentMatch.player2.username}`;
                document.getElementById('match-team1-logo').src = currentMatch.player1.team.logo;
                document.getElementById('match-team1-name').textContent = currentMatch.player1.username;
                document.getElementById('match-team2-logo').src = currentMatch.player2.team.logo;
                document.getElementById('match-team2-name').textContent = currentMatch.player2.username;
                
                // Устанавливаем счет
                document.getElementById('match-team1-score').value = currentMatch.score1 !== null ? currentMatch.score1 : '';
                document.getElementById('match-team2-score').value = currentMatch.score2 !== null ? currentMatch.score2 : '';
                
                // Настраиваем статус матча
                const statusElement = document.getElementById('match-status');
                if (currentMatch.status === 'pending') {
                    statusElement.textContent = 'Ожидает подтверждения';
                    statusElement.className = 'match-status status-pending';
                } else if (currentMatch.status === 'completed') {
                    statusElement.textContent = 'Завершен';
                    statusElement.className = 'match-status status-confirmed';
                }
                
                // Настраиваем видимость кнопок
                submitMatchBtn.style.display = 'none';
                confirmMatchBtn.style.display = 'none';
                rejectMatchBtn.style.display = 'none';
                
                if (currentMatch.status === 'pending') {
                    if (isPlayer1 && currentMatch.score1 === null) {
                        // Игрок 1 может отправить результат
                        submitMatchBtn.style.display = 'inline-block';
                    } else if (isPlayer2 && currentMatch.score2 === null) {
                        // Игрок 2 может подтвердить или отклонить результат
                        confirmMatchBtn.style.display = 'inline-block';
                        rejectMatchBtn.style.display = 'inline-block';
                    } else if (isAdminView) {
                        // Админ может подтвердить или отклонить результат
                        confirmMatchBtn.style.display = 'inline-block';
                        rejectMatchBtn.style.display = 'inline-block';
                    }
                }
                
                // Показываем модальное окно
                showModal(matchModal);
            }
            
            // Показать модальное окно создания/редактирования турнира
            function showEditTournamentModal(tournamentId = null) {
                editingTournamentId = tournamentId;
                
                if (tournamentId) {
                    // Редактирование существующего турнира
                    const tournament = tournaments.find(t => t.id === tournamentId);
                    if (!tournament) return;
                    
                    document.getElementById('edit-tournament-title').textContent = 'Редактировать турнир';
                    document.getElementById('tournament-name').value = tournament.name;
                    document.getElementById('tournament-image').value = tournament.image;
                    document.getElementById('tournament-start').value = tournament.startDate;
                    document.getElementById('tournament-end').value = tournament.endDate;
                    document.getElementById('tournament-prize').value = tournament.prize;
                    document.getElementById('tournament-level').value = tournament.level;
                    document.getElementById('tournament-description').value = tournament.description;
                    document.getElementById('tournament-type').value = tournament.type;
                    document.getElementById('tournament-max-teams').value = tournament.maxTeams;
                } else {
                    // Создание нового турнира
                    document.getElementById('edit-tournament-title').textContent = 'Создать турнир';
                    document.getElementById('edit-tournament-form').reset();
                    
                    // Устанавливаем даты по умолчанию
                    const today = new Date().toISOString().split('T')[0];
                    const nextWeek = new Date();
                    nextWeek.setDate(nextWeek.getDate() + 7);
                    const nextWeekFormatted = nextWeek.toISOString().split('T')[0];
                    
                    document.getElementById('tournament-start').value = today;
                    document.getElementById('tournament-end').value = nextWeekFormatted;
                }
                
                showModal(editTournamentModal);
            }
            
            // Показать модальное окно удаления турнира
            function showDeleteTournamentModal() {
                const selectElement = document.getElementById('select-tournament-to-delete');
                selectElement.innerHTML = '';
                
                // Заполняем список турниров
                tournaments.forEach(tournament => {
                    const option = document.createElement('option');
                    option.value = tournament.id;
                    option.textContent = tournament.name;
                    selectElement.appendChild(option);
                });
                
                showModal(deleteTournamentModal);
            }
            
            // Провести жеребьевку турнира
            function drawTournament() {
                if (!currentTournament) return;
                
                // Проверяем, что турнир еще не начался
                if (currentTournament.matches.length > 0) {
                    alert('Жеребьевка уже была проведена для этого турнира!');
                    return;
                }
                
                // Проверяем, что есть участники
                if (currentTournament.participants.length < 2) {
                    alert('Для проведения жеребьевки нужно минимум 2 участника!');
                    return;
                }
                
                // В зависимости от типа турнира проводим разную жеребьевку
                if (currentTournament.type === 'Кубок') {
                    // Для кубка просто перемешиваем участники
                    const shuffledParticipants = [...currentTournament.participants].sort(() => Math.random() - 0.5);
                    
                    // Создаем матчи для первого раунда
                    for (let i = 0; i < shuffledParticipants.length; i += 2) {
                        if (i + 1 < shuffledParticipants.length) {
                            const matchId = matches.length > 0 ? Math.max(...matches.map(m => m.id)) + 1 : 1;
                            matches.push({
                                id: matchId,
                                tournamentId: currentTournament.id,
                                player1: shuffledParticipants[i],
                                player2: shuffledParticipants[i + 1],
                                score1: null,
                                score2: null,
                                status: 'pending',
                                round: 1
                            });
                        }
                    }
                } else if (currentTournament.type === 'Лига') {
                    // Для лиги создаем матчи каждый против каждого (2 круга)
                    const participants = currentTournament.participants;
                    let matchId = matches.length > 0 ? Math.max(...matches.map(m => m.id)) + 1 : 1;
                    
                    // Первый круг
                    for (let i = 0; i < participants.length; i++) {
                        for (let j = i + 1; j < participants.length; j++) {
                            matches.push({
                                id: matchId++,
                                tournamentId: currentTournament.id,
                                player1: participants[i],
                                player2: participants[j],
                                score1: null,
                                score2: null,
                                status: 'pending',
                                round: 1
                            });
                        }
                    }
                    
                    // Второй круг (домашние и гостевые матчи меняются местами)
                    for (let i = 0; i < participants.length; i++) {
                        for (let j = i + 1; j < participants.length; j++) {
                            matches.push({
                                id: matchId++,
                                tournamentId: currentTournament.id,
                                player1: participants[j],
                                player2: participants[i],
                                score1: null,
                                score2: null,
                                status: 'pending',
                                round: 2
                            });
                        }
                    }
                } else if (currentTournament.type === 'Группы+Плейофф') {
                    // Для групп + плейофф сначала делим на группы, потом плейофф
                    const groupCount = Math.ceil(currentTournament.participants.length / 4);
                    const groups = [];
                    
                    // Создаем группы
                    for (let i = 0; i < groupCount; i++) {
                        groups.push([]);
                    }
                    
                    // Распределяем участников по группам случайным образом
                    const shuffledParticipants = [...currentTournament.participants].sort(() => Math.random() - 0.5);
                    let groupIndex = 0;
                    
                    shuffledParticipants.forEach(participant => {
                        groups[groupIndex].push(participant);
                        groupIndex = (groupIndex + 1) % groupCount;
                    });
                    
                    // Создаем матчи в группах (каждый против каждого, 2 круга)
                    let matchId = matches.length > 0 ? Math.max(...matches.map(m => m.id)) + 1 : 1;
                    
                    groups.forEach((group, groupNumber) => {
                        // Первый круг
                        for (let i = 0; i < group.length; i++) {
                            for (let j = i + 1; j < group.length; j++) {
                                matches.push({
                                    id: matchId++,
                                    tournamentId: currentTournament.id,
                                    player1: group[i],
                                    player2: group[j],
                                    score1: null,
                                    score2: null,
                                    status: 'pending',
                                    round: `Группа ${groupNumber + 1} - 1 круг`
                                });
                            }
                        }
                        
                        // Второй круг
                        for (let i = 0; i < group.length; i++) {
                            for (let j = i + 1; j < group.length; j++) {
                                matches.push({
                                    id: matchId++,
                                    tournamentId: currentTournament.id,
                                    player1: group[j],
                                    player2: group[i],
                                    score1: null,
                                    score2: null,
                                    status: 'pending',
                                    round: `Группа ${groupNumber + 1} - 2 круг`
                                });
                            }
                        }
                    });
                }
                
                // Сохраняем матчи в localStorage
                localStorage.setItem('matches', JSON.stringify(matches));
                
                alert('Жеребьевка проведена успешно! Матчи созданы.');
                
                // Обновляем интерфейс
                renderUserMatches();
                
                // Если это турнир-лига, обновляем таблицу
                if (currentTournament.type === 'Лига') {
                    renderStandings();
                }
            }
            
            // Форматировать дату
            function formatDate(dateString) {
                const options = { day: 'numeric', month: 'long' };
                return new Date(dateString).toLocaleDateString('ru-RU', options);
            }
            
            // Показать модальное окно
            function showModal(modal) {
                modal.style.display = 'flex';
                document.body.style.overflow = 'hidden';
            }
            
            // Скрыть модальное окно
            function hideModal(modal) {
                modal.style.display = 'none';
                document.body.style.overflow = 'auto';
            }
            
            // Войти в систему
            function login(email, password) {
                // В реальном приложении здесь был бы запрос к серверу
                if (email === 'admin@fc25.com' && password === 'admin123') {
                    currentUser = {
                        id: 999,
                        username: 'Администратор',
                        email: email,
                        isAdmin: true
                    };
                    isAdmin = true;
                } else {
                    currentUser = {
                        id: Math.floor(Math.random() * 1000) + 1,
                        username: `Игрок_${Math.floor(Math.random() * 1000)}`,
                        email: email,
                        isAdmin: false
                    };
                    isAdmin = false;
                }
                
                // Сохраняем пользователя в localStorage
                localStorage.setItem('currentUser', JSON.stringify(currentUser));
                
                // Обновляем интерфейс
                updateProfile();
                authText.textContent = 'Выйти';
                
                // Показываем профиль
                showPage('profile');
                
                // Обновляем турниры и матчи
                renderUserTournaments();
                renderUserMatches();
                
                // Если это админ, показываем админскую панель
                if (isAdmin) {
                    adminSection.style.display = 'block';
                }
                
                // Скрываем модальное окно входа
                hideModal(registerModal);
                
                alert('Вы успешно вошли в систему!');
            }
            
            // Выйти из системы
            function logout() {
                currentUser = null;
                isAdmin = false;
                
                // Удаляем пользователя из localStorage
                localStorage.removeItem('currentUser');
                
                // Обновляем интерфейс
                authText.textContent = 'Войти';
                adminSection.style.display = 'none';
                
                // Показываем главную страницу
                showPage('home');
            }
            
            // Зарегистрироваться
            function register(username, email, password) {
                // В реальном приложении здесь был бы запрос к серверу
                currentUser = {
                    id: Math.floor(Math.random() * 1000) + 1,
                    username: username,
                    email: email,
                    isAdmin: false
                };
                
                // Сохраняем пользователя в localStorage
                localStorage.setItem('currentUser', JSON.stringify(currentUser));
                
                // Обновляем интерфейс
                updateProfile();
                authText.textContent = 'Выйти';
                
                // Показываем профиль
                showPage('profile');
                
                // Скрываем модальное окно регистрации
                hideModal(registerModal);
                
                alert('Регистрация прошла успешно! Вы автоматически вошли в систему.');
            }
            
            // Присоединиться к турниру
            function joinTournament() {
                if (!currentUser || !currentTournament || !selectedTeam) return;
                
                // Проверяем, не участвует ли уже пользователь в турнире
                const isAlreadyParticipant = currentTournament.participants.some(p => p.id === currentUser.id);
                if (isAlreadyParticipant) {
                    alert('Вы уже участвуете в этом турнире!');
                    return;
                }
                
                // Проверяем, не занята ли выбранная команда
                const isTeamTaken = currentTournament.participants.some(p => p.team.id === selectedTeam.id);
                if (isTeamTaken) {
                    alert('Эта команда уже занята в этом турнире!');
                    return;
                }
                
                // Добавляем пользователя в участники турнира
                currentTournament.participants.push({
                    id: currentUser.id,
                    username: currentUser.username,
                    email: currentUser.email,
                    team: selectedTeam
                });
                
                // Сохраняем турниры в localStorage
                localStorage.setItem('tournaments', JSON.stringify(tournaments));
                
                // Обновляем интерфейс
                renderTournaments();
                renderUserTournaments();
                
                // Закрываем модальное окно
                hideModal(tournamentModal);
                
                alert(`Вы успешно зарегистрированы на турнир "${currentTournament.name}" за команду ${selectedTeam.name}!`);
            }
            
            // Покинуть турнир
            function leaveTournament() {
                if (!currentUser || !currentTournament) return;
                
                // Удаляем пользователя из участников турнира
                currentTournament.participants = currentTournament.participants.filter(p => p.id !== currentUser.id);
                
                // Удаляем все матчи пользователя в этом турнире
                matches = matches.filter(m => 
                    !(m.tournamentId === currentTournament.id && 
                      (m.player1.id === currentUser.id || m.player2.id === currentUser.id))
                );
                
                // Сохраняем данные в localStorage
                localStorage.setItem('tournaments', JSON.stringify(tournaments));
                localStorage.setItem('matches', JSON.stringify(matches));
                
                // Обновляем интерфейс
                renderTournaments();
                renderUserTournaments();
                renderUserMatches();
                updateProfile();
                
                // Закрываем модальное окно
                hideModal(tournamentModal);
                
                alert(`Вы покинули турнир "${currentTournament.name}"`);
            }
            
            // Создать/обновить турнир
            function saveTournament() {
                const name = document.getElementById('tournament-name').value;
                const image = document.getElementById('tournament-image').value || 'https://media.contentapi.ea.com/content/dam/ea/fifa/fifa-23/ultimate-team/common/fut23-tournament-featured-image-16x9.jpg.adapt.crop16x9.1023w.jpg';
                const startDate = document.getElementById('tournament-start').value;
                const endDate = document.getElementById('tournament-end').value;
                const prize = document.getElementById('tournament-prize').value;
                const level = document.getElementById('tournament-level').value;
                const description = document.getElementById('tournament-description').value;
                const type = document.getElementById('tournament-type').value;
                const maxTeams = parseInt(document.getElementById('tournament-max-teams').value);
                
                if (new Date(startDate) > new Date(endDate)) {
                    alert('Дата окончания не может быть раньше даты начала!');
                    return;
                }
                
                if (editingTournamentId) {
                    // Обновляем существующий турнир
                    const tournamentIndex = tournaments.findIndex(t => t.id === editingTournamentId);
                    if (tournamentIndex !== -1) {
                        tournaments[tournamentIndex] = {
                            ...tournaments[tournamentIndex],
                            name,
                            image,
                            startDate,
                            endDate,
                            prize,
                            level,
                            description,
                            type,
                            maxTeams
                        };
                    }
                } else {
                    // Создаем новый турнир
                    const newId = tournaments.length > 0 ? Math.max(...tournaments.map(t => t.id)) + 1 : 1;
                    
                    tournaments.push({
                        id: newId,
                        name,
                        image,
                        startDate,
                        endDate,
                        prize,
                        level,
                        description,
                        type,
                        maxTeams,
                        participants: [],
                        matches: [],
                        status: new Date(startDate) <= new Date() ? 'active' : 'upcoming'
                    });
                }
                
                // Сохраняем турниры в localStorage
                localStorage.setItem('tournaments', JSON.stringify(tournaments));
                
                // Обновляем интерфейс
                renderTournaments();
                
                // Закрываем модальное окно
                hideModal(editTournamentModal);
                
                alert(`Турнир "${name}" успешно ${editingTournamentId ? 'обновлен' : 'создан'}!`);
            }
            
            // Удалить турнир
            function deleteTournament() {
                const selectElement = document.getElementById('select-tournament-to-delete');
                const tournamentId = parseInt(selectElement.value);
                
                if (!tournamentId) {
                    alert('Пожалуйста, выберите турнир для удаления');
                    return;
                }
                
                const tournament = tournaments.find(t => t.id === tournamentId);
                if (!tournament) return;
                
                if (!confirm(`Вы уверены, что хотите удалить турнир "${tournament.name}"?`)) {
                    return;
                }
                
                // Удаляем турнир
                tournaments = tournaments.filter(t => t.id !== tournamentId);
                
                // Удаляем все матчи этого турнира
                matches = matches.filter(m => m.tournamentId !== tournamentId);
                
                // Сохраняем данные в localStorage
                localStorage.setItem('tournaments', JSON.stringify(tournaments));
                localStorage.setItem('matches', JSON.stringify(matches));
                
                // Обновляем интерфейс
                renderTournaments();
                renderUserTournaments();
                renderUserMatches();
                
                // Закрываем модальное окно
                hideModal(deleteTournamentModal);
                
                alert(`Турнир "${tournament.name}" успешно удален!`);
            }
            
            // Отправить результат матча
            function submitMatchResult() {
                if (!currentMatch || !currentUser) return;
                
                const score1 = parseInt(document.getElementById('match-team1-score').value) || 0;
                const score2 = parseInt(document.getElementById('match-team2-score').value) || 0;
                const comment = document.getElementById('match-comment').value;
                
                // Проверяем, чтобы игрок не подтверждал матч с самим собой
                if (currentMatch.player1.id === currentMatch.player2.id) {
                    alert('Нельзя играть матч с самим собой!');
                    return;
                }
                
                // Проверяем, чтобы игроки не играли друг с другом более 2 раз (для лиг)
                if (currentTournament && currentTournament.type === 'Лига') {
                    const existingMatches = matches.filter(m => 
                        m.tournamentId === currentTournament.id &&
                        m.status === 'completed' &&
                        ((m.player1.id === currentMatch.player1.id && m.player2.id === currentMatch.player2.id) ||
                         (m.player1.id === currentMatch.player2.id && m.player2.id === currentMatch.player1.id))
                    ).length;
                    
                    if (existingMatches >= 2) {
                        alert('Вы уже сыграли 2 матча с этим соперником в этом турнире!');
                        return;
                    }
                }
                
                // Обновляем результат матча
                if (currentUser.id === currentMatch.player1.id) {
                    currentMatch.score1 = score1;
                    currentMatch.score2 = score2;
                } else if (currentUser.id === currentMatch.player2.id) {
                    // Игрок 2 подтверждает результат
                    currentMatch.status = 'completed';
                }
                
                currentMatch.comment = comment;
                
                // Сохраняем матчи в localStorage
                localStorage.setItem('matches', JSON.stringify(matches));
                
                // Обновляем интерфейс
                renderUserMatches();
                updateProfile();
                
                // Если это турнир-лига, обновляем таблицу
                if (currentTournament && currentTournament.type === 'Лига') {
                    renderStandings();
                }
                
                // Закрываем модальное окно
                hideModal(matchModal);
                
                if (currentUser.id === currentMatch.player1.id) {
                    alert('Результат матча отправлен на подтверждение сопернику!');
                } else {
                    alert('Результат матча подтвержден!');
                }
            }
            
            // Подтвердить результат матча
            function confirmMatch() {
                if (!currentMatch) return;
                
                currentMatch.status = 'completed';
                
                // Сохраняем матчи в localStorage
                localStorage.setItem('matches', JSON.stringify(matches));
                
                // Обновляем интерфейс
                renderUserMatches();
                updateProfile();
                
                // Если это турнир-лига, обновляем таблицу
                if (currentTournament && currentTournament.type === 'Лига') {
                    renderStandings();
                }
                
                // Закрываем модальное окно
                hideModal(matchModal);
                
                alert('Результат матча подтвержден!');
            }
            
            // Отклонить результат матча
            function rejectMatch() {
                if (!currentMatch) return;
                
                // Сбрасываем результаты
                currentMatch.score1 = null;
                currentMatch.score2 = null;
                currentMatch.status = 'pending';
                
                // Сохраняем матчи в localStorage
                localStorage.setItem('matches', JSON.stringify(matches));
                
                // Обновляем интерфейс
                renderUserMatches();
                
                // Закрываем модальное окно
                hideModal(matchModal);
                
                alert('Результат матча отклонен! Ожидается повторная отправка результата.');
            }
            
            // Обработчики навигации
            navLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const pageId = this.getAttribute('data-page');
                    
                    // Если это кнопка входа/выхода
                    if (pageId === 'login') {
                        if (currentUser) {
                            logout();
                            return;
                        }
                    }
                    
                    showPage(pageId);
                });
            });
            
            // Обработчики модального окна регистрации
            registerBtn.addEventListener('click', function(e) {
                e.preventDefault();
                showModal(registerModal);
            });
            
            showRegisterLink.addEventListener('click', function(e) {
                e.preventDefault();
                hideModal(tournamentModal);
                showModal(registerModal);
            });
            
            cancelRegisterBtn.addEventListener('click', function() {
                hideModal(registerModal);
            });
            
            closeRegisterModal.addEventListener('click', function() {
                hideModal(registerModal);
            });
            
            // Обработчик формы входа
            loginForm.addEventListener('submit', function(e) {
                e.preventDefault();
                const email = document.getElementById('login-email').value;
                const password = document.getElementById('login-password').value;
                
                if (!email || !password) {
                    alert('Пожалуйста, заполните все поля');
                    return;
                }
                
                login(email, password);
            });
            
            cancelLoginBtn.addEventListener('click', function() {
                showPage('home');
            });
            
            // Обработчик формы регистрации
            registerForm.addEventListener('submit', function(e) {
                e.preventDefault();
                const username = document.getElementById('register-username').value;
                const email = document.getElementById('register-email').value;
                const password = document.getElementById('register-password').value;
                const confirm = document.getElementById('register-confirm').value;
                
                if (!username || !email || !password || !confirm) {
                    alert('Пожалуйста, заполните все поля');
                    return;
                }
                
                if (password !== confirm) {
                    alert('Пароли не совпадают!');
                    return;
                }
                
                register(username, email, password);
            });
            
            // Обработчики модального окна турнира
            closeTournamentModal.addEventListener('click', function() {
                hideModal(tournamentModal);
            });
            
            closeTournamentBtn.addEventListener('click', function() {
                hideModal(tournamentModal);
            });
            
            joinTournamentBtn.addEventListener('click', function() {
                if (!currentUser) {
                    hideModal(tournamentModal);
                    showModal(registerModal);
                    return;
                }
                
                if (!selectedTeam) {
                    alert('Пожалуйста, выберите команду для участия');
                    return;
                }
                
                joinTournament();
            });
            
            leaveTournamentBtn.addEventListener('click', function() {
                if (confirm(`Вы уверены, что хотите покинуть турнир "${currentTournament.name}"?`)) {
                    leaveTournament();
                }
            });
            
            adminEditBtn.addEventListener('click', function() {
                hideModal(tournamentModal);
                showEditTournamentModal(currentTournament.id);
            });
            
            // Обработчики модального окна создания/редактирования турнира
            createTournamentBtn.addEventListener('click', function() {
                showEditTournamentModal();
            });
            
            deleteTournamentBtn.addEventListener('click', function() {
                showDeleteTournamentModal();
            });
            
            drawTournamentBtn.addEventListener('click', function() {
                if (confirm(`Провести жеребьевку турнира "${currentTournament.name}"?`)) {
                    drawTournament();
                }
            });
            
            cancelEditTournamentBtn.addEventListener('click', function() {
                hideModal(editTournamentModal);
            });
            
            editTournamentForm.addEventListener('submit', function(e) {
                e.preventDefault();
                saveTournament();
            });
            
            // Обработчики модального окна удаления турнира
            cancelDeleteTournamentBtn.addEventListener('click', function() {
                hideModal(deleteTournamentModal);
            });
            
            confirmDeleteTournamentBtn.addEventListener('click', function() {
                deleteTournament();
            });
            
            // Обработчики модального окна матча
            closeMatchModal.addEventListener('click', function() {
                hideModal(matchModal);
            });
            
            submitMatchBtn.addEventListener('click', function() {
                submitMatchResult();
            });
            
            confirmMatchBtn.addEventListener('click', function() {
                confirmMatch();
            });
            
            rejectMatchBtn.addEventListener('click', function() {
                rejectMatch();
            });
            
            // Инициализация приложения
            init();
        });
    </script>
</body>
</html>
